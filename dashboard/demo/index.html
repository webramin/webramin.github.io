<!DOCTYPE html>
<html lang="ir">
<head>
<title>مدریت صفحه ها</title>
    <!-- Meta -->
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" id="" content="#000000">
    <meta name="color-scheme" content="dark light" />
    <meta name="msapplication-TileColor" content="#000000">
    <meta name="msapplication-TileImage" content="https://webramin.storage.iran.liara.space/logo/ms-icon-144x144.png">
    <!-- Logos -->
    <link rel="apple-touch-icon" sizes="57x57" href="https://webramin.storage.iran.liara.space/logo/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="https://webramin.storage.iran.liara.space/logo/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="https://webramin.storage.iran.liara.space/logo/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="https://webramin.storage.iran.liara.space/logo/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="https://webramin.storage.iran.liara.space/logo/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="https://webramin.storage.iran.liara.space/logo/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="https://webramin.storage.iran.liara.space/logo/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="https://webramin.storage.iran.liara.space/logo/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://webramin.storage.iran.liara.space/logo/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="https://webramin.storage.iran.liara.space/logo/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://webramin.storage.iran.liara.space/logo/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="https://webramin.storage.iran.liara.space/logo/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://webramin.storage.iran.liara.space/logo/favicon-16x16.png">
    <link rel="manifest" href="https://webramin.storage.iran.liara.space/logo/manifest.json">
    <!-- style css -->
    <link rel="stylesheet" href="https://webramin.github.io/css/style.css" type="text/css">
    <link rel="stylesheet" type="text/css" href="https://webramin.github.io/css/web.css" media="all" />
    <link rel="stylesheet" href="https://webramin.github.io/font/iransans/iran-sans.css">
    <link rel="stylesheet" href="https://webramin.github.io/font/bootstrap/bootstrap-icons.css">
    <link rel="stylesheet" href="https://webramin.github.io/css/ico-img/ico-img.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://webramin.github.io/js/jquery-3.7.0.min.js"></script>
  
</head>

<body>
    <div class="container">
        <form class="my-5 text-end d-print-none">
            <div class="d-flex justify-content-end">
                <div class="col-12 col-md-4">
                    <input type="text" placeholder="جستوجو" class="form-control text-end" id="pageTable_filter">
                </div>
            </div>
        </form>

        <div class="d-flex d-print-none flex-row-reverse mb-3">
            <a href="https://github.com/webramin/webramin.github.io/archive/refs/heads/min.zip" class="btn btn-pill btn-primary mx-2">دانلود</a>
            <a href="https://github.com/webramin/webramin.github.io/new/min" class="btn btn-pill btn-primary mx-2">ایجاد فایل</a>
            <a href="https://github.com/webramin/webramin.github.io/upload/min" class="btn btn-pill btn-primary mx-2">آپلود</a>
            <a href="https://github.com/webramin/webramin.github.io/" class="btn btn-pill btn-primary mx-2">مشاهده صفحه اصلی</a>
        </div>
        <div class="d-flex d-print-none flex-row-reverse mb-3">
            <a href="#" class="btn btn-pill btn-primary mx-2" data-bs-toggle="modal" data-bs-target="#pagesModal">مدیریت آیتم‌ها</a>
            <a href="#" class="btn btn-pill btn-primary mx-2" data-bs-toggle="modal" data-bs-target="#addPageModal">افزودن آیتم</a>
            <!--new--><button class="btn btn-pill btn-primary mx-2" id="toggleLinkTarget">
            <i class="bi bi-box-arrow-up-right"></i>
             باز شدن لینک‌ها در برگه جدید
            </button>
                
        </div>
        <nav class="mb-3 d-print-none">
            <ol class="breadcrumb breadcrumb-arrows">
                <li class="breadcrumb-item"><a href="#">github</a></li>
                <li class="breadcrumb-item"><a href="#">webramin</a></li>
                <li class="breadcrumb-item active">webramin.github.io</li>
            </ol>
        </nav>
        <div class="row">
            <div class="col">
                <table class="table text-center" id="pageTable">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>عنوان صفحه</th>
                            <th>عملکرد</th>
                        </tr>
                    </thead>
                    <tbody>
                </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- مودال برای افزودن صفحه جدید -->
    <div class="modal d-print-none fade" id="addPageModal" tabindex="-1" aria-labelledby="addPageModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addPageModalLabel">افزودن صفحه جدید</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="title" class="form-label">عنوان صفحه</label>
                        <input type="text" class="form-control" id="title" placeholder="صفحه">
                    </div>
                    <div class="mb-3">
                        <label for="repoUrl" class="form-label">آدرس مخزن گیت‌هاب</label>
                        <input type="text" class="form-control" id="repoUrl" placeholder="https://github.com/username/repository" value="https://github.com/webramin/webramin.github.io/">
                    </div>
                    <div class="mb-3">
                        <label for="fileUrl" class="form-label">آدرس فایل</label>
                        <input type="text" class="form-control" id="fileUrl" placeholder="/index.html" value="/...">
                    </div>
                    <div class="mb-3">
                        <label for="previewUrl" class="form-label">آدرس مرورگر</label>
                        <input type="text" class="form-control" id="previewUrl" placeholder="https://webramin.github.io" value="https://webramin.github.io">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">بستن</button>
                    <button type="button" class="btn btn-primary" onclick="addPage()">افزودن</button>
                </div>
            </div>
        </div>
    </div>

    <!-- مودال برای مدیریت آیتم‌ها -->
    <div class="modal d-print-none fade" id="pagesModal" tabindex="-1" aria-labelledby="pagesModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="pagesModalLabel">مدیریت آیتم‌ها</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <ul class="list-group" id="pagesList">
                        <!-- آیتم‌ها در اینجا نمایش داده می‌شوند -->
                    </ul>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">بستن</button>
                </div>
            </div>
        </div>
    </div>

    <!-- مودال برای ویرایش آیتم -->
    <div class="modal d-print-none fade" id="editPageModal" tabindex="-1" aria-labelledby="editPageModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editPageModalLabel">ویرایش صفحه</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="editTitle" class="form-label">عنوان صفحه</label>
                        <input type="text" class="form-control" id="editTitle" placeholder="صفحه">
                    </div>
                    <div class="mb-3">
                        <label for="editRepoUrl" class="form-label">آدرس مخزن گیت‌هاب</label>
                        <input type="text" class="form-control" id="editRepoUrl" placeholder="https://github.com/username/repository" value="https://github.com/webramin/webramin.github.io/">
                    </div>
                    <div class="mb-3">
                        <label for="editFileUrl" class="form-label">آدرس فایل</label>
                        <input type="text" class="form-control" id="editFileUrl" placeholder="/index.html" value="/...">
                    </div>
                    <div class="mb-3">
                        <label for="editPreviewUrl" class="form-label">آدرس مرورگر</label>
                        <input type="text" class="form-control" id="editPreviewUrl" placeholder="https://webramin.github.io" value="https://webramin.github.io">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">بستن</button>
                    <button type="button" class="btn btn-primary" onclick="updatePage()">ذخیره</button>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript" charset="utf-8">
$(document).ready(function() {
    // رویداد کلیک بر روی فیلتر جدول
    $('#pageTable_filter').on('keyup', function() {
        filterTable();
    });

    // بارگذاری داده‌ها در جدول و مودال مدیریت آیتم‌ها
    loadDataInTable();
    loadPagesInModal();
    
    // new 203 متغیر برای نگهداری وضعیت لینک‌ها
    let openInNewTab = false;

    // تابع برای فعال/غیرفعال کردن target="_blank" در لینک‌ها
    function toggleLinkTarget() {
        if (openInNewTab) {
            $('a').attr('target', '_blank');
            $('#toggleLinkTarget').html('<i class="bi bi-box-arrow-up-right"></i> باز شدن لینک‌ها در برگه جدید');
        } else {
            $('a').removeAttr('target');
            $('#toggleLinkTarget').html('<i class="bi bi-box-arrow-in-up-right"></i> باز شدن لینک‌ها در همین صفحه');
        }
        openInNewTab = !openInNewTab;
    }
    // رویداد کلیک بر روی دکمه
    $('#toggleLinkTarget').click(toggleLinkTarget);

    // اجرای تابع برای تنظیم اولیه لینک‌ها
    toggleLinkTarget();
});
// افزودن صفحه جدید
function addPage() {
    const $modal = $('#addPageModal');
    const pageData = getPageDataFromForm();

    // ذخیره‌سازی داده‌ها در localStorage
    savePageData(pageData);

    // بروزرسانی جدول و مودال مدیریت آیتم‌ها
    loadDataInTable();
    loadPagesInModal();

    // بستن مودال
    $modal.modal('hide');
}

// ویرایش صفحه
function editPage(index) {
    const pages = getPageDataFromStorage();
    const page = pages[index];
    const $modal = $('#editPageModal');

    // پر کردن فیلدهای مودال ویرایش
    fillEditPageModal(page);

    // باز کردن مودال ویرایش
    $modal.data('index', index);
    $modal.modal('show');
}

// بروزرسانی صفحه
function updatePage() {
    const $modal = $('#editPageModal');
    const index = $modal.data('index');
    const pageData = getPageDataFromEditModal();

    // بروزرسانی داده‌ها در localStorage
    updatePageData(index, pageData);

    // بروزرسانی جدول و مودال مدیریت آیتم‌ها
    loadDataInTable();
    loadPagesInModal();

    // بستن مودال ویرایش
    $modal.modal('hide');
}

// حذف صفحه
function deletePage(index) {
    // حذف داده از localStorage
    deletePageData(index);

    // بروزرسانی جدول و مودال مدیریت آیتم‌ها
    loadDataInTable();
    loadPagesInModal();
}

// بارگذاری داده‌ها در جدول
function loadDataInTable() {
    const $table = $('#pageTable tbody');
    $table.empty();

    const pages = getPageDataFromStorage();
    pages.forEach((page, index) => {
        addRowToTable(page, index + 1);
    });
}

// بارگذاری آیتم‌ها در مودال مدیریت
function loadPagesInModal() {
    const $pagesList = $('#pagesList');
    $pagesList.empty();

    const pages = getPageDataFromStorage();
    pages.forEach((page, index) => {
        addItemToModal(page, index);
    });
}

// فیلتر کردن جدول
function filterTable() {
    const $input = $('#pageTable_filter');
    const filter = $input.val().toUpperCase();
    const $table = $('#pageTable');
    const $tr = $table.find('tbody tr');

    $tr.each(function() {
        const $td = $(this).find('td:eq(1)');
        const txtValue = $td.text().toUpperCase();
        if (txtValue.indexOf(filter) > -1) {
            $(this).show();
        } else {
            $(this).hide();
        }
    });
}

// دریافت داده‌های صفحه از فرم
function getPageDataFromForm() {
    return {
        title: $('#title').val(),
        repoUrl: $('#repoUrl').val(),
        fileUrl: $('#fileUrl').val(),
        previewUrl: $('#previewUrl').val()
    };
}

// دریافت داده‌های صفحه از localStorage
function getPageDataFromStorage() {
    return JSON.parse(localStorage.getItem('pages')) || [];
}

// ذخیره‌سازی داده‌های صفحه در localStorage
function savePageData(pageData) {
    const pages = getPageDataFromStorage();
    pages.push(pageData);
    localStorage.setItem('pages', JSON.stringify(pages));
}

// بروزرسانی داده‌های صفحه در localStorage
function updatePageData(index, pageData) {
    const pages = getPageDataFromStorage();
    pages[index] = pageData;
    localStorage.setItem('pages', JSON.stringify(pages));
}

// حذف داده‌های صفحه از localStorage
function deletePageData(index) {
    const pages = getPageDataFromStorage();
    pages.splice(index, 1);
    localStorage.setItem('pages', JSON.stringify(pages));
}

// افزودن ردیف جدید به جدول
function addRowToTable(pageData, index) {
    const $table = $('#pageTable tbody');
    const $newRow = $('<tr></tr>');
    $newRow.html(`
        <td>${index}</td>
        <td>${pageData.title}</td>
        <td>
            <div class="btn-group">
                <div class="btn-group">
                    <a href="${pageData.previewUrl}" class="btn btn-success"><i class="bi bi-eye"></i></a>
                    <button type="button" class="btn btn-success dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                        <span class="visually-hidden"></span>
                    </button>
                    <ul class="dropdown-menu">
                        <li class="dropdown-item">
                            <div class="input-group">
                                <input class="form-control" value="${pageData.previewUrl}">
                                <a data-copy-text="${pageData.previewUrl}" class="btn"><i class="bi bi-copy"></i></a>
                            </div>
                        </li>
                    </ul>
                </div>
                <a class="btn btn-github" href="${pageData.repoUrl}/blob/min${pageData.fileUrl}"><i class="bi bi-github"></i></a>
                <a class="btn btn-primary" href="${pageData.repoUrl}/edit/min${pageData.fileUrl}"><i class="bi bi-pencil"></i></a>
                <a class="btn btn-danger" href="${pageData.repoUrl}/delete/min${pageData.fileUrl}"><i class="bi bi-trash"></i></a>
            </div>
        </td>
    `);
    $table.append($newRow);
}

// افزودن آیتم به مودال مدیریت
function addItemToModal(pageData, index) {
    const $pagesList = $('#pagesList');
    const $listItem = $('<li class="list-group-item d-flex justify-content-between align-items-center"></li>');
    $listItem.html(`
        <div>
            <span class="fw-bold">${index + 1}.</span>
            <span>${pageData.title}</span>
        </div>
        <div>
            <button class="btn btn-primary" onclick="editPage(${index})"><i class="bi bi-pencil"></i></button>
            <button class="btn btn-danger" onclick="deletePage(${index})"><i class="bi bi-trash"></i></button>
        </div>
    `);
    $pagesList.append($listItem);
}

// پر کردن فیلدهای مودال ویرایش
function fillEditPageModal(pageData) {
    $('#editTitle').val(pageData.title);
    $('#editRepoUrl').val(pageData.repoUrl);
    $('#editFileUrl').val(pageData.fileUrl);
    $('#editPreviewUrl').val(pageData.previewUrl);
}

// دریافت داده‌های صفحه از مودال ویرایش
function getPageDataFromEditModal() {
    return {
        title: $('#editTitle').val(),
        repoUrl: $('#editRepoUrl').val(),
        fileUrl: $('#editFileUrl').val(),
        previewUrl: $('#editPreviewUrl').val()
    };
}
    </script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://webramin.github.io/js/bootstrap.bundle.js"></script>
    <script src="https://webramin.github.io/js/color-modes.js"></script>
    <script src="https://webramin.github.io/js/popper.min.js"></script>
    <script src="https://webramin.github.io/js/script.js"></script>
    <script src="https://webramin.github.io/p/data.js"></script>
    <script src="https://webramin.github.io/js/app"></script>
</body>
  </html>
